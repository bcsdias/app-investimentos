2025-11-19 16:12:59,100 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:13:00,878 - INFO - Dados capturados com sucesso!
2025-11-19 16:13:00,932 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:13:00,933 - INFO - Gerando gráficos...
2025-11-19 16:13:01,917 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:13:03,794 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:13:03,796 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:13:04,035 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:13:04,242 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:13:04,244 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:13:04,244 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:13:05,731 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:13:06,269 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:13:06,609 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:13:06,610 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:13:06,611 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:13:06,612 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:13:06,612 - INFO - Inicializando driver do Chrome...
2025-11-19 16:13:12,898 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:13:15,161 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:16,073 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:16,082 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv
2025-11-19 16:13:16,085 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:13:17,469 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:17,976 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:17,978 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:13:17,979 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:13:19,149 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:19,654 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:19,657 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:13:19,657 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:13:20,725 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:21,235 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:21,238 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:13:21,239 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:13:22,395 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:22,902 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:22,906 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:13:22,906 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:13:24,066 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:24,574 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:24,577 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:13:24,580 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:13:24,581 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:13:25,199 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:25,706 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:25,709 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:13:25,709 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:13:29,327 - INFO - Driver do Chrome encerrado.
2025-11-19 16:13:29,413 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 16:13:29,413 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IBOV'.
2025-11-19 16:13:29,415 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:13:29,415 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:13:29,416 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:13:29,416 - INFO - Inicializando driver do Chrome...
2025-11-19 16:13:35,739 - INFO - Iniciando download para o índice 'IBOV', ano 2019.
2025-11-19 16:13:37,566 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:38,584 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:38,592 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2019.csv
2025-11-19 16:13:38,597 - INFO - Iniciando download para o índice 'IBOV', ano 2020.
2025-11-19 16:13:40,029 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:40,743 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:40,749 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2020.csv
2025-11-19 16:13:40,753 - INFO - Iniciando download para o índice 'IBOV', ano 2021.
2025-11-19 16:13:42,229 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:42,734 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:42,736 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2021.csv
2025-11-19 16:13:42,738 - INFO - Iniciando download para o índice 'IBOV', ano 2022.
2025-11-19 16:13:43,878 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:44,487 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:44,491 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2022.csv
2025-11-19 16:13:44,494 - INFO - Iniciando download para o índice 'IBOV', ano 2023.
2025-11-19 16:13:45,818 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:46,323 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:46,326 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2023.csv
2025-11-19 16:13:46,327 - INFO - Iniciando download para o índice 'IBOV', ano 2024.
2025-11-19 16:13:47,494 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:48,102 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:48,102 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2024.csv
2025-11-19 16:13:48,102 - INFO - Iniciando download para o índice 'IBOV', ano 2025.
2025-11-19 16:13:48,709 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:13:49,322 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:13:49,322 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2025.csv
2025-11-19 16:13:49,322 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:13:52,581 - INFO - Driver do Chrome encerrado.
2025-11-19 16:13:52,668 - INFO - Dados do índice 'IBOV' da B3 processados com sucesso.
2025-11-19 16:13:52,668 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 16:14:04,055 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 16:14:05,248 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 16:14:05,658 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
             ^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for /: 'str' and 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 604, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 596, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 452, in gerar_grafico_comparativo_twr
    benchmark_normalizado = (dados_benchmark / dados_benchmark.iloc[0]) * 100
                             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\arraylike.py", line 210, in __truediv__
    return self._arith_method(other, operator.truediv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\series.py", line 6154, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 227, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 182, in _masked_arith_op
    result[mask] = op(xrav[mask], y)
                   ^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for /: 'str' and 'str'
2025-11-19 16:16:34,740 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:16:36,298 - INFO - Dados capturados com sucesso!
2025-11-19 16:16:36,423 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:16:36,423 - INFO - Gerando gráficos...
2025-11-19 16:16:37,830 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:16:40,117 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:16:40,119 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:16:40,348 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:16:40,571 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:16:40,579 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:16:40,579 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:16:41,602 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:16:42,168 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:16:42,489 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:16:42,491 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:16:42,492 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:16:42,493 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:16:42,493 - INFO - Inicializando driver do Chrome...
2025-11-19 16:16:48,666 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:16:50,911 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:16:51,820 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:16:51,820 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv' foi removido para ser substituído.
2025-11-19 16:16:51,820 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv
2025-11-19 16:16:51,827 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:16:53,042 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:16:53,750 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:16:53,753 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv' foi removido para ser substituído.
2025-11-19 16:16:53,782 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:16:53,784 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:16:54,858 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:16:55,566 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:16:55,570 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv' foi removido para ser substituído.
2025-11-19 16:16:55,572 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:16:55,572 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:16:56,182 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:16:56,795 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:16:56,795 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv' foi removido para ser substituído.
2025-11-19 16:16:56,803 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:16:56,803 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:16:57,974 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:16:58,581 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:16:58,583 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv' foi removido para ser substituído.
2025-11-19 16:16:58,604 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:16:58,605 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:16:59,737 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:17:00,547 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:17:00,549 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:17:00,573 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:17:00,574 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:17:01,610 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:17:02,317 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:17:02,317 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv' foi removido para ser substituído.
2025-11-19 16:17:02,324 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:17:02,324 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:17:05,254 - INFO - Driver do Chrome encerrado.
2025-11-19 16:17:05,263 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 609, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 582, in main
    benchmarks_data[nome] = buscar_dados_b3(indice, start_date, end_date, logger)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 411, in buscar_dados_b3
    df_unpivoted['Close'] = df_unpivoted['Close'].str.replace('.', '', regex=False).astype(float)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\generic.py", line 6665, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\managers.py", line 449, in astype
    return self.apply(
           ^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\managers.py", line 363, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\blocks.py", line 784, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\dtypes\astype.py", line 237, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\dtypes\astype.py", line 182, in astype_array
    values = _astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\dtypes\astype.py", line 133, in _astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: '2367,76'
2025-11-19 16:24:32,270 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 16:24:32,271 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:24:33,929 - INFO - Dados capturados com sucesso!
2025-11-19 16:24:33,973 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:24:33,973 - INFO - Gerando gráficos...
2025-11-19 16:24:34,757 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:24:36,469 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:24:36,469 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:24:36,681 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:24:36,935 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:24:36,935 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:24:36,935 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:24:42,230 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:24:42,707 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:24:43,015 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:24:43,015 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:24:43,015 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:24:43,015 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:24:43,015 - INFO - Inicializando driver do Chrome...
2025-11-19 16:24:48,372 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:24:50,883 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:24:51,593 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:24:51,597 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv' foi removido para ser substituído.
2025-11-19 16:24:51,620 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv
2025-11-19 16:24:51,621 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:24:52,771 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:24:53,378 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:24:53,378 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv' foi removido para ser substituído.
2025-11-19 16:24:53,378 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:24:53,378 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:24:54,475 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:24:55,082 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:24:55,082 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv' foi removido para ser substituído.
2025-11-19 16:24:55,085 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:24:55,087 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:24:56,210 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:24:56,817 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:24:56,819 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv' foi removido para ser substituído.
2025-11-19 16:24:56,822 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:24:56,822 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:24:58,036 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:24:58,542 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:24:58,542 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv' foi removido para ser substituído.
2025-11-19 16:24:58,546 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:24:58,548 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:24:59,654 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:00,260 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:00,260 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:25:00,267 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:25:00,268 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:25:00,845 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:01,453 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:01,456 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv' foi removido para ser substituído.
2025-11-19 16:25:01,469 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:25:01,470 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:25:04,175 - INFO - Driver do Chrome encerrado.
2025-11-19 16:25:04,273 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 16:25:04,273 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IBOV'.
2025-11-19 16:25:04,273 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:25:04,273 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:25:04,273 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:25:04,273 - INFO - Inicializando driver do Chrome...
2025-11-19 16:25:10,593 - INFO - Iniciando download para o índice 'IBOV', ano 2019.
2025-11-19 16:25:13,161 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:13,974 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:13,980 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2019.csv' foi removido para ser substituído.
2025-11-19 16:25:13,984 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2019.csv
2025-11-19 16:25:13,985 - INFO - Iniciando download para o índice 'IBOV', ano 2020.
2025-11-19 16:25:15,472 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:15,978 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:15,980 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2020.csv' foi removido para ser substituído.
2025-11-19 16:25:15,985 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2020.csv
2025-11-19 16:25:15,985 - INFO - Iniciando download para o índice 'IBOV', ano 2021.
2025-11-19 16:25:17,159 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:17,666 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:17,669 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2021.csv' foi removido para ser substituído.
2025-11-19 16:25:17,671 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2021.csv
2025-11-19 16:25:17,673 - INFO - Iniciando download para o índice 'IBOV', ano 2022.
2025-11-19 16:25:18,906 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:19,411 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:19,413 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2022.csv' foi removido para ser substituído.
2025-11-19 16:25:19,433 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2022.csv
2025-11-19 16:25:19,435 - INFO - Iniciando download para o índice 'IBOV', ano 2023.
2025-11-19 16:25:20,649 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:21,157 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:21,157 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2023.csv' foi removido para ser substituído.
2025-11-19 16:25:21,157 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2023.csv
2025-11-19 16:25:21,162 - INFO - Iniciando download para o índice 'IBOV', ano 2024.
2025-11-19 16:25:22,314 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:22,820 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:22,823 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2024.csv' foi removido para ser substituído.
2025-11-19 16:25:22,827 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2024.csv
2025-11-19 16:25:22,828 - INFO - Iniciando download para o índice 'IBOV', ano 2025.
2025-11-19 16:25:23,444 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:25:23,950 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:25:23,950 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2025.csv' foi removido para ser substituído.
2025-11-19 16:25:23,958 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IBOV-2025.csv
2025-11-19 16:25:23,958 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:25:26,834 - INFO - Driver do Chrome encerrado.
2025-11-19 16:25:26,925 - INFO - Dados do índice 'IBOV' da B3 processados com sucesso.
2025-11-19 16:25:26,925 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 16:25:27,625 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 16:25:28,259 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 16:25:31,024 - INFO - Gráfico comparativo de TWR salvo com sucesso em: dlombello/graficos\comparativo_twr_AÇÃO.png
2025-11-19 16:41:10,150 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 16:41:10,153 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:41:11,863 - INFO - Dados capturados com sucesso!
2025-11-19 16:41:11,914 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:41:11,915 - INFO - Gerando gráficos...
2025-11-19 16:41:12,792 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:41:14,571 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:41:14,574 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:41:14,758 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:41:14,949 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:41:14,958 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:41:14,958 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:41:16,155 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:41:16,717 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:41:17,114 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:41:17,114 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:41:17,114 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:41:17,114 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:41:17,114 - INFO - Inicializando driver do Chrome...
2025-11-19 16:41:23,317 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:41:57,846 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2019. Erro: Message: 
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xeb4103
	0xeb4144
	0xcbe71d
	0xd0a03d
	0xd0a41b
	0xd517f2
	0xd2c954
	0xd4ee17
	0xd2c706
	0xcfda30
	0xcfed54
	0x11257b4
	0x112098a
	0xedc392
	0xecc4c8
	0xed324d
	0xebc478
	0xebc63c
	0xea67ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 16:41:57,851 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:41:59,690 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:42:00,400 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:42:00,410 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv' foi removido para ser substituído.
2025-11-19 16:42:00,416 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:42:00,418 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:42:01,623 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:42:02,128 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:42:02,132 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv' foi removido para ser substituído.
2025-11-19 16:42:02,134 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:42:02,137 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:42:03,311 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:42:03,922 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:42:03,925 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv' foi removido para ser substituído.
2025-11-19 16:42:03,927 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:42:03,927 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:42:05,106 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:42:05,813 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:42:05,813 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv' foi removido para ser substituído.
2025-11-19 16:42:05,819 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:42:05,819 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:42:06,884 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:42:07,491 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:42:07,494 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:42:07,496 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:42:07,496 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:42:08,010 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:42:08,817 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:42:08,817 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv' foi removido para ser substituído.
2025-11-19 16:42:08,823 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:42:08,824 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:42:11,828 - INFO - Driver do Chrome encerrado.
2025-11-19 16:42:11,925 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 16:42:11,925 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 16:42:21,416 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 16:42:22,311 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 16:43:24,199 - INFO - Gráfico comparativo de TWR salvo com sucesso em: dlombello/graficos\comparativo_twr_AÇÃO.png
2025-11-19 16:50:49,691 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 16:50:49,691 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:50:51,381 - INFO - Dados capturados com sucesso!
2025-11-19 16:50:51,437 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:50:51,439 - INFO - Gerando gráficos...
2025-11-19 16:50:52,163 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:50:53,597 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:50:53,597 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:50:53,796 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:50:53,974 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:50:53,974 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:50:53,974 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:50:55,236 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:50:55,652 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:50:56,056 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:50:56,056 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:50:56,062 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:50:56,062 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:50:56,062 - INFO - Inicializando driver do Chrome...
2025-11-19 16:51:01,721 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:51:03,575 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:04,385 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:04,397 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv' foi removido para ser substituído.
2025-11-19 16:51:04,407 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv
2025-11-19 16:51:04,408 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:51:05,537 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:06,145 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:06,149 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv' foi removido para ser substituído.
2025-11-19 16:51:06,152 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:51:06,152 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:51:07,256 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:07,761 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:07,766 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv' foi removido para ser substituído.
2025-11-19 16:51:07,772 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:51:07,774 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:51:08,950 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:09,455 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:09,456 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv' foi removido para ser substituído.
2025-11-19 16:51:09,460 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:51:09,460 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:51:10,575 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:11,081 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:11,081 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv' foi removido para ser substituído.
2025-11-19 16:51:11,102 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:51:11,102 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:51:12,172 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:12,678 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:12,680 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:51:12,683 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:51:12,683 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:51:13,202 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:51:13,809 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:51:13,811 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv' foi removido para ser substituído.
2025-11-19 16:51:13,818 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:51:13,822 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:51:16,902 - INFO - Driver do Chrome encerrado.
2025-11-19 16:51:16,980 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 16:51:16,980 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 16:51:17,652 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 16:51:18,250 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 16:51:22,649 - INFO - Gráfico comparativo de TWR salvo com sucesso em: dlombello/graficos\comparativo_twr_AÇÃO.png
2025-11-19 16:53:18,951 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 16:53:18,951 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:53:20,917 - INFO - Dados capturados com sucesso!
2025-11-19 16:53:20,960 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:53:20,974 - INFO - Gerando gráficos...
2025-11-19 16:53:21,758 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:53:23,559 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:53:23,559 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:53:23,804 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:53:24,094 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:53:24,094 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:53:24,094 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:53:24,966 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:53:25,547 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:53:25,961 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:53:25,961 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:53:25,961 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:53:25,961 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:53:25,969 - INFO - Inicializando driver do Chrome...
2025-11-19 16:53:32,066 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:53:34,197 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:34,907 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:34,915 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv' foi removido para ser substituído.
2025-11-19 16:53:34,921 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv
2025-11-19 16:53:34,923 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:53:36,187 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:36,693 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:36,693 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv' foi removido para ser substituído.
2025-11-19 16:53:36,693 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:53:36,693 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:53:37,846 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:38,353 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:38,353 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv' foi removido para ser substituído.
2025-11-19 16:53:38,369 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:53:38,369 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:53:39,476 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:40,083 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:40,083 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv' foi removido para ser substituído.
2025-11-19 16:53:40,102 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:53:40,102 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:53:41,191 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:41,696 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:41,700 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv' foi removido para ser substituído.
2025-11-19 16:53:41,733 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:53:41,735 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:53:42,853 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:43,358 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:43,360 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:53:43,365 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:53:43,365 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:53:43,895 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:53:44,401 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:53:44,401 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv' foi removido para ser substituído.
2025-11-19 16:53:44,424 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:53:44,426 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:53:47,419 - INFO - Driver do Chrome encerrado.
2025-11-19 16:53:47,501 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 16:53:47,501 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 16:53:48,146 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 16:53:48,739 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 16:53:52,903 - INFO - Gráfico comparativo de TWR salvo com sucesso em: dlombello/graficos\comparativo_twr_AÇÃO.png
2025-11-19 16:59:21,810 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 16:59:21,810 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 16:59:23,645 - INFO - Dados capturados com sucesso!
2025-11-19 16:59:23,670 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 16:59:23,670 - INFO - Gerando gráficos...
2025-11-19 16:59:24,500 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 16:59:25,956 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 16:59:25,956 - INFO - Iniciando cálculo de TWR...
2025-11-19 16:59:26,134 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 16:59:26,286 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 16:59:26,302 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 16:59:26,302 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 16:59:27,326 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 16:59:27,783 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 16:59:28,190 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 16:59:28,190 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 16:59:28,190 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 16:59:28,190 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 16:59:28,190 - INFO - Inicializando driver do Chrome...
2025-11-19 16:59:33,397 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 16:59:35,092 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:35,905 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:35,911 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv' foi removido para ser substituído.
2025-11-19 16:59:35,921 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2019.csv
2025-11-19 16:59:35,924 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 16:59:37,073 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:37,579 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:37,584 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv' foi removido para ser substituído.
2025-11-19 16:59:37,605 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2020.csv
2025-11-19 16:59:37,607 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 16:59:38,696 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:39,203 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:39,205 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv' foi removido para ser substituído.
2025-11-19 16:59:39,222 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2021.csv
2025-11-19 16:59:39,223 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 16:59:40,353 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:40,858 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:40,861 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv' foi removido para ser substituído.
2025-11-19 16:59:40,864 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2022.csv
2025-11-19 16:59:40,865 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 16:59:42,057 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:42,566 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:42,566 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv' foi removido para ser substituído.
2025-11-19 16:59:42,571 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2023.csv
2025-11-19 16:59:42,572 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 16:59:43,689 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:44,196 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:44,199 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv' foi removido para ser substituído.
2025-11-19 16:59:44,213 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2024.csv
2025-11-19 16:59:44,214 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 16:59:44,798 - INFO - Botão de download clicado. Aguardando o arquivo...
2025-11-19 16:59:45,304 - INFO - Arquivo 'Evolucao_Diaria.csv' encontrado na pasta de downloads.
2025-11-19 16:59:45,307 - WARNING - Arquivo de destino existente 'C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv' foi removido para ser substituído.
2025-11-19 16:59:45,307 - INFO - Arquivo renomeado e movido para: C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\dados/IFIX-2025.csv
2025-11-19 16:59:45,307 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 16:59:48,226 - INFO - Driver do Chrome encerrado.
2025-11-19 16:59:48,345 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 16:59:48,345 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 16:59:59,867 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:00:00,936 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:00:02,848 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 703, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 695, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 575, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 469, in calcular_rentabilidades_resumo
    df_resumo = pd.DataFrame(resumo_data).T # Transpõe para ter os anos como colunas
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 782, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 630, in sanitize_array
    return sanitize_array(
           ^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 656, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 715, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (7, 1) instead
2025-11-19 17:00:40,215 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:00:40,215 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:00:42,173 - INFO - Dados capturados com sucesso!
2025-11-19 17:00:42,221 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:00:42,221 - INFO - Gerando gráficos...
2025-11-19 17:00:42,894 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:00:44,555 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:00:44,555 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:00:44,745 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:00:44,961 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:00:44,961 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:00:44,961 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:00:45,800 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:00:46,338 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:00:46,789 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:00:46,800 - INFO - Iniciando orquestrador de downloads da B3.
2025-11-19 17:00:46,804 - INFO - --- Iniciando script de download de dados da B3 ---
2025-11-19 17:00:46,806 - INFO - Pastas de trabalho verificadas/criadas com sucesso.
2025-11-19 17:00:46,807 - INFO - Inicializando driver do Chrome...
2025-11-19 17:00:52,444 - INFO - Iniciando download para o índice 'IFIX', ano 2019.
2025-11-19 17:01:04,064 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2019. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,093 - INFO - Iniciando download para o índice 'IFIX', ano 2020.
2025-11-19 17:01:04,127 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2020. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,132 - INFO - Iniciando download para o índice 'IFIX', ano 2021.
2025-11-19 17:01:04,178 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2021. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,186 - INFO - Iniciando download para o índice 'IFIX', ano 2022.
2025-11-19 17:01:04,216 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2022. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,223 - INFO - Iniciando download para o índice 'IFIX', ano 2023.
2025-11-19 17:01:04,263 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2023. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,264 - INFO - Iniciando download para o índice 'IFIX', ano 2024.
2025-11-19 17:01:04,280 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2024. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,282 - INFO - Iniciando download para o índice 'IFIX', ano 2025.
2025-11-19 17:01:04,301 - ERROR - Falha ao baixar dados para o índice 'IFIX' ano 2025. Erro: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=142.0.7444.162)
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0xb54103
	0xb54144
	0x95e71d
	0x93c32d
	0x9d329e
	0x9ee749
	0x9cc706
	0x99da30
	0x99ed54
	0xdc57b4
	0xdc098a
	0xb7c392
	0xb6c4c8
	0xb7324d
	0xb5c478
	0xb5c63c
	0xb467ca
	0x75835d49
	0x7749d6db
	0x7749d661

2025-11-19 17:01:04,305 - INFO - --- Processo de download da B3 finalizado. ---
2025-11-19 17:01:06,935 - INFO - Driver do Chrome encerrado.
2025-11-19 17:01:07,011 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:01:07,012 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:01:07,562 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:01:08,015 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:01:10,356 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 703, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 695, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 575, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 469, in calcular_rentabilidades_resumo
    df_resumo = pd.DataFrame(resumo_data).T # Transpõe para ter os anos como colunas
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 782, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 630, in sanitize_array
    return sanitize_array(
           ^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 656, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 715, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (7, 1) instead
2025-11-19 17:04:35,921 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:04:35,921 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:04:37,669 - INFO - Dados capturados com sucesso!
2025-11-19 17:04:37,715 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:04:37,716 - INFO - Gerando gráficos...
2025-11-19 17:04:38,429 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:04:40,201 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:04:40,201 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:04:40,413 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:04:40,597 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:04:40,597 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:04:40,597 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:04:41,451 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:04:41,922 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:04:42,331 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:04:42,331 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:04:42,452 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:04:42,452 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:04:43,070 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:04:43,599 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:04:45,246 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 715, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 707, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 587, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 481, in calcular_rentabilidades_resumo
    df_resumo = pd.DataFrame(resumo_data).T # Transpõe para ter os anos como colunas
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 782, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 630, in sanitize_array
    return sanitize_array(
           ^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 656, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 715, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (7, 1) instead
2025-11-19 17:07:26,368 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:07:26,369 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:07:28,218 - INFO - Dados capturados com sucesso!
2025-11-19 17:07:28,273 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:07:28,273 - INFO - Gerando gráficos...
2025-11-19 17:07:29,168 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:07:31,299 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:07:31,299 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:07:31,490 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:07:31,692 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:07:31,704 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:07:31,705 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:07:32,674 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:07:33,261 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:07:33,561 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:07:33,561 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:07:33,677 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:07:33,677 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:07:34,443 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:07:35,140 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:07:37,013 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexes\datetimes.py", line 603, in get_loc
    parsed, reso = self._parse_with_reso(key)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexes\datetimes.py", line 559, in _parse_with_reso
    parsed, reso = super()._parse_with_reso(label)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexes\datetimelike.py", line 293, in _parse_with_reso
    parsed, reso_str = parsing.parse_datetime_string_with_reso(label, freqstr)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/tslibs/parsing.pyx", line 442, in pandas._libs.tslibs.parsing.parse_datetime_string_with_reso
  File "pandas/_libs/tslibs/parsing.pyx", line 666, in pandas._libs.tslibs.parsing.dateutil_parse
pandas._libs.tslibs.parsing.DateParseError: Unknown datetime string format, unable to parse: twr_acc

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 715, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 707, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 587, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 461, in calcular_rentabilidades_resumo
    df_carteira['fator'] = df_carteira['twr_acc'] + 1
                           ~~~~~~~~~~~^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\series.py", line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\series.py", line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexes\datetimes.py", line 605, in get_loc
    raise KeyError(key) from err
KeyError: 'twr_acc'
2025-11-19 17:09:17,141 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:09:17,157 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:09:18,845 - INFO - Dados capturados com sucesso!
2025-11-19 17:09:18,884 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:09:18,884 - INFO - Gerando gráficos...
2025-11-19 17:09:19,624 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:09:21,255 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:09:21,255 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:09:21,477 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:09:21,644 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:09:21,644 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:09:21,644 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:09:22,562 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:09:23,064 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:09:23,479 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:09:23,479 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:09:23,593 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:09:23,599 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:09:24,242 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:09:24,780 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:09:26,491 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 717, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 709, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 589, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 483, in calcular_rentabilidades_resumo
    df_resumo = pd.DataFrame(resumo_data).T # Transpõe para ter os anos como colunas
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 782, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\internals\construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 630, in sanitize_array
    return sanitize_array(
           ^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 656, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\construction.py", line 715, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (7, 1) instead
2025-11-19 17:10:56,910 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:10:56,910 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:10:58,646 - INFO - Dados capturados com sucesso!
2025-11-19 17:10:58,687 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:10:58,687 - INFO - Gerando gráficos...
2025-11-19 17:10:59,395 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:11:01,286 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:11:01,302 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:11:01,480 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:11:01,708 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:11:01,708 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:11:01,708 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:11:02,532 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:11:02,977 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:11:03,390 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:11:03,390 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:11:03,504 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:11:03,504 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:11:04,217 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:11:04,768 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:11:06,519 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 725, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 717, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 597, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 456, in calcular_rentabilidades_resumo
    logger.debug("Iniciando cálculo de rentabilidades para a tabela de resumo.")
    ^^^^^^
NameError: name 'logger' is not defined
2025-11-19 17:13:26,392 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:13:26,392 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:13:28,133 - INFO - Dados capturados com sucesso!
2025-11-19 17:13:28,195 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:13:28,198 - INFO - Gerando gráficos...
2025-11-19 17:13:29,066 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:13:31,165 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:13:31,167 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:13:31,394 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:13:31,592 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:13:31,596 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:13:31,597 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:13:32,451 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:13:33,307 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:13:33,706 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:13:33,706 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:13:33,800 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:13:33,803 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:13:34,433 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:13:35,033 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:13:36,988 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 725, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 717, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 597, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico, logger)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 499, in calcular_rentabilidades_resumo
    df_resumo.loc[nome, 'Total'] = total_bench
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexing.py", line 912, in __setitem__
    iloc._setitem_with_indexer(indexer, value, self.name)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexing.py", line 1943, in _setitem_with_indexer
    self._setitem_with_indexer_split_path(indexer, value, name)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexing.py", line 1964, in _setitem_with_indexer_split_path
    value = self._align_series(indexer, Series(value))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\indexing.py", line 2456, in _align_series
    raise ValueError("Incompatible indexer with Series")
ValueError: Incompatible indexer with Series
2025-11-19 17:14:49,107 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:14:49,123 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:14:50,810 - INFO - Dados capturados com sucesso!
2025-11-19 17:14:50,850 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:14:50,852 - INFO - Gerando gráficos...
2025-11-19 17:14:51,672 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:14:53,725 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:14:53,725 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:14:53,971 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:14:54,189 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:14:54,189 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:14:54,189 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:14:55,019 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:14:55,643 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:14:56,058 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:14:56,058 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:14:56,180 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:14:56,180 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:14:57,076 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:14:57,683 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:14:59,430 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 729, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 721, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 601, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico, logger)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 510, in calcular_rentabilidades_resumo
    df_resumo[col] = df_resumo[col].apply(lambda x: f'{x:.1%}' if pd.notna(x) else '-')
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\series.py", line 4943, in apply
    ).apply()
      ^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 510, in <lambda>
    df_resumo[col] = df_resumo[col].apply(lambda x: f'{x:.1%}' if pd.notna(x) else '-')
                                                                  ^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-11-19 17:17:35,291 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:17:35,291 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:17:37,129 - INFO - Dados capturados com sucesso!
2025-11-19 17:17:37,191 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:17:37,193 - INFO - Gerando gráficos...
2025-11-19 17:17:37,950 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:17:39,776 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:17:39,776 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:17:39,941 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:17:40,202 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:17:40,202 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:17:40,202 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:17:41,919 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:17:42,500 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:17:43,127 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:17:43,127 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:17:43,224 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:17:43,225 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:17:55,944 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:17:57,329 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:17:58,979 - ERROR - Ocorreu um erro fatal não capturado na execução principal.
Traceback (most recent call last):
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 732, in <module>
    main()
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 724, in main
    gerar_grafico_comparativo_twr(df_twr, benchmarks_data, nome_grafico=nome_analise, logger=logger)
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 604, in gerar_grafico_comparativo_twr
    df_resumo = calcular_rentabilidades_resumo(df_twr, benchmarks_data, nome_grafico, logger)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 513, in calcular_rentabilidades_resumo
    df_resumo = df_resumo.applymap(lambda x: f'{x:.1%}' if pd.notna(x) else '-')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 10549, in applymap
    return self.map(func, na_action=na_action, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 10495, in map
    return self.apply(infer).__finalize__(self, "map")
           ^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 10401, in apply
    return op.apply().__finalize__(self, method="apply")
           ^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\frame.py", line 10493, in infer
    return x._map_values(func, na_action=na_action)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\dlombello\main.py", line 513, in <lambda>
    df_resumo = df_resumo.applymap(lambda x: f'{x:.1%}' if pd.notna(x) else '-')
                                                           ^^^^^^^^^^^
  File "C:\onedrive-bcsdias\OneDrive\dev\app_investimentos\.venv\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-11-19 17:23:05,722 - INFO - 

==================== NOVA ANÁLISE ====================
2025-11-19 17:23:05,737 - INFO - Buscando histórico na API com os parâmetros: {'classe': 'AÇÃO'}
2025-11-19 17:23:07,498 - INFO - Dados capturados com sucesso!
2025-11-19 17:23:07,537 - INFO - Histórico completo salvo em: dlombello/graficos\historico_completo_AÇÃO.csv
2025-11-19 17:23:07,537 - INFO - Gerando gráficos...
2025-11-19 17:23:08,276 - INFO - Dados do gráfico de evolução salvos em: dlombello/graficos\evolucao_AÇÃO.csv
2025-11-19 17:23:11,251 - INFO - Gráfico de evolução salvo com sucesso em: dlombello/graficos\evolucao_AÇÃO.png
2025-11-19 17:23:11,288 - INFO - Iniciando cálculo de TWR...
2025-11-19 17:23:11,942 - INFO - Dados do gráfico de TWR salvos em: dlombello/graficos\evolucao_twr_AÇÃO.csv
2025-11-19 17:23:12,472 - INFO - Gráfico de TWR salvo com sucesso em: dlombello/graficos\evolucao_twr_AÇÃO.png
2025-11-19 17:23:12,477 - INFO - Período da análise: 2019-04-30 a 2025-10-31
2025-11-19 17:23:12,478 - INFO - Buscando dados para o benchmark: ^BVSP...
2025-11-19 17:23:14,093 - INFO - Buscando dados para o benchmark: SPY...
2025-11-19 17:23:14,691 - INFO - Buscando dados para o benchmark: IMID.L...
2025-11-19 17:23:15,139 - INFO - Iniciando processo de obtenção de dados da B3 para o índice 'IFIX'.
2025-11-19 17:23:15,142 - INFO - Todos os arquivos necessários para o índice 'IFIX' já existem localmente. Download pulado.
2025-11-19 17:23:15,266 - INFO - Dados do índice 'IFIX' da B3 processados com sucesso.
2025-11-19 17:23:15,266 - INFO - Buscando dados da série 11 do BCB...
2025-11-19 17:23:16,045 - INFO - Buscando dados da série 433 do BCB...
2025-11-19 17:23:16,596 - INFO - Calculando benchmark sintético 'IPCA + 6%'...
2025-11-19 17:23:19,816 - INFO - Gráfico comparativo de TWR salvo com sucesso em: dlombello/graficos\comparativo_twr_AÇÃO.png
